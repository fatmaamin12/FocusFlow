<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Focus Flow | Login</title>

<!-- Fonts & Icons -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
<link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">

<!-- Auth CSS -->
<link rel="stylesheet" href="{{ url_for('static', filename='css/auth.css') }}">

</head>
<body>

<div class="auth-wrapper">

  <!-- LOGIN BOX -->
  <div class="auth-box {% if show_signup %}hidden{% endif %}" id="loginBox">
    <h1>Welcome Back ðŸ‘‹</h1>
    <p>Sign in to your productivity hub</p>

    {% if error and not show_signup %}
      <div class="error-msg">{{ error }}</div>
    {% endif %}
    
    <form action="/login" method="POST" id="loginForm" class="auth-form">
      <div class="input-box">
        <input type="email" name="email" placeholder="Email" required>
      </div>

      <div class="input-box password-box">
        <input type="password" name="password" id="loginPassword" placeholder="Password" required>
        <i class='bx bx-hide toggle-pass' data-target="loginPassword"></i>
      </div>

      <button type="submit" class="auth-btn">Sign In</button>
    </form>

    <p class="switch">New here? <a href="#" id="showSignup">Create Account</a></p>
  </div>

  <!-- SIGNUP BOX -->
  <div class="auth-box {% if not show_signup %}hidden{% endif %}" id="signupBox">
    <h1>Create Account âœ¨</h1>
    <p>Join the productivity hub</p>

    {% if error and show_signup %}
      <div class="error-msg">{{ error }}</div>
    {% endif %}
    
    <form action="/signup" method="POST" id="signupForm" class="auth-form">
      <div class="input-box">
        <input type="text" name="name" placeholder="Full Name" required>
      </div>

      <div class="input-box">
        <input type="email" name="email" placeholder="Email" required>
      </div>

      <div class="input-box password-box">
        <input type="password" name="password" id="signupPassword" placeholder="Password" required>
        <i class='bx bx-hide toggle-pass' data-target="signupPassword"></i>
      </div>

      <button type="submit" class="auth-btn">Sign Up</button>
    </form>

    <p class="switch">Already have an account? <a href="#" id="showLogin">Sign In</a></p>
  </div>

</div>

<!-- SCRIPT -->
<script>
/***************************
 * ELEMENTS
 **************************/
const loginBox = document.getElementById("loginBox");
const signupBox = document.getElementById("signupBox");
const showSignup = document.getElementById("showSignup");
const showLogin = document.getElementById("showLogin");

const signupForm = document.getElementById("signupForm");
const loginForm = document.getElementById("loginForm");

/***************************
 * TOGGLE LOGIN <-> SIGNUP
 **************************/
if (showSignup) {
  showSignup.onclick = e => {
    e.preventDefault();
    loginBox.classList.add("hidden");
    signupBox.classList.remove("hidden");
  };
}

if (showLogin) {
  showLogin.onclick = e => {
    e.preventDefault();
    signupBox.classList.add("hidden");
    loginBox.classList.remove("hidden");
  };
}

/***************************
 * SIGNUP HANDLER (frontend storage)
 **************************/
if (signupForm) {
  signupForm.addEventListener("submit", function (e) {

    const nameField = signupForm.querySelector("input[name='name']");
    const fullName = nameField.value.trim();

    const parts = fullName.split(" ").filter(p => p.length > 0);
    if (parts.length < 2) {
      e.preventDefault();
      alert("Please enter your full name (first and last).");
      nameField.focus();
      return;
    }

    const email = signupForm.querySelector("input[name='email']").value.trim();
    const password = signupForm.querySelector("input[name='password']").value.trim();

    const user = { name: fullName, email, password };
    localStorage.setItem("user", JSON.stringify(user));
  });
}

/***************************
 * LOGIN HANDLER (frontend storage)
 **************************/
if (loginForm) {
  loginForm.addEventListener("submit", function (e) {

    const email = loginForm.querySelector("input[name='email']").value.trim();
    const password = loginForm.querySelector("input[name='password']").value.trim();

    const savedUser = JSON.parse(localStorage.getItem("user"));

  });
}

/***************************
 * SHOW / HIDE PASSWORD
 **************************/
document.querySelectorAll(".toggle-pass").forEach(icon => {
  icon.addEventListener("click", () => {
    const targetId = icon.getAttribute("data-target");
    const input = document.getElementById(targetId);

    if (input.type === "password") {
      input.type = "text";
      icon.classList.remove("bx-hide");
      icon.classList.add("bx-show");
    } else {
      input.type = "password";
      icon.classList.remove("bx-show");
      icon.classList.add("bx-hide");
    }
  });
});
</script>

</body>
</html>
